<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Software Genlock: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Software Genlock
   &#160;<span id="projectnumber">v2.0.0</span>
   </div>
   <div id="projectbrief">Digital Signage SW Library for adjusting VSYNC timings via MMIO PLL register modifications.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Software Genlock Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> Copyright (C) 2023 Intel Corporation SPDX-License-Identifier: MIT</p>
<p>This program allows a system to alter their vertical sync firing times. This is sample code only and is only supported on 11th Gen Core. Please note that this document was written based on Ubuntu</p>
<h1><a class="anchor" id="autotoc_md15"></a>
Prerequisites</h1>
<p>The build system assumes the following, prior to executing the build steps: 1) The system has an <a href="https://ubuntu.com/tutorials/install-ubuntu-desktop#1-overview">Ubuntu OS</a> 1) Libraries installed: <code>sudo apt install -y git build-essential make</code> 1) <a href="https://wiki.ubuntu.com/UEFI/SecureBoot/DKMS">Disable secure boot</a> 1) You MUST apply the <a href="./resources/0001-dpll-Provide-a-command-line-param-to-config-if-PLLs-.patch">PLL kernel patch</a>.</p><ul>
<li>Following the application of the patch, edit the grub settings: ```console sudo vi /etc/grub/default </li>
</ul>
<h1><a class="anchor" id="autotoc_md16"></a>
add i915.share_dplls=0 to the GRUB_CMDLINE_LINUX options:</h1>
<h1><a class="anchor" id="autotoc_md17"></a>
GRUB_CMDLINE_LINUX="i915.share_dplls=0"</h1>
<h1><a class="anchor" id="autotoc_md18"></a>
Save and exit, then update grub</h1>
<p>update-grub ```</p>
<h1><a class="anchor" id="autotoc_md19"></a>
Building steps:</h1>
<p>1) Git clone this repository 1) <code>sudo apt install libdrm-dev libpciaccess-dev</code> 1) If the directory /usr/include/drm does not exist, you may need to also add <code>sudo apt install -y linux-libc-dev</code> 1) Type <code>make release</code> from the main directory. It compiles everything and creates a release folder which can then be copied to the target systems.</p>
<h1><a class="anchor" id="autotoc_md20"></a>
Notes</h1>
<ul>
<li>By default this is set to move vsync by 1.0 ms. in <a href="./synctest/synctest.cpp">synctest/synctest.cpp</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md21"></a>
Debug</h1>
<p>You can turn on debug printing automatically by building with <code>make debug</code> There is a dbg_lvl flag which can be set to INFO, DBG, ERR etc.</p>
<p><b>sample output:</b> </p><div class="fragment"><div class="line">./synctest</div>
<div class="line"> </div>
<div class="line">[DBG] Device id is 0xA780</div>
<div class="line">[DBG] 0x60400 = 0xA0030011</div>
<div class="line">[DBG] ddi_select = 0x4</div>
<div class="line">[DBG] Detected a Combo phy on pipe 1</div>
<div class="line">[DBG] 0x164280 = 0xE07410</div>
<div class="line">[DBG] DPLL num = 0x0</div>
<div class="line">[DBG] 0x61400 = 0xAA110006</div>
<div class="line">[DBG] ddi_select = 0x5</div>
<div class="line">[DBG] Detected a Combo phy on pipe 2</div>
<div class="line">[DBG] 0x164280 = 0xE07410</div>
<div class="line">[DBG] DPLL num = 0x1</div>
<div class="line">[DBG] 0x62400 = 0x0</div>
<div class="line">[DBG] Pipe 3 is turned off</div>
<div class="line">[DBG] 0x63400 = 0x0</div>
<div class="line">[DBG] Pipe 4 is turned off</div>
<div class="line">[DBG] steps are 1000</div>
<div class="line">[DBG] OLD VALUES</div>
<div class="line"> cfgcr0 [0x164284] =     0x1001D0</div>
<div class="line"> cfgcr1 [0x164288] =     0x448</div>
<div class="line">[DBG] old pll_freq   594.000000</div>
<div class="line">[DBG] new_pll_freq   594.594000</div>
<div class="line">[DBG] old dco_clock      8910.000000</div>
<div class="line">[DBG] new dco_clock      8918.910000</div>
<div class="line">[DBG] old fbdivfrac      0x400</div>
<div class="line">[DBG] old ro_div_frac    0x8000</div>
<div class="line">[DBG] old fbdivint   0x1D0</div>
<div class="line">[DBG] old ro_div_int     0x3A</div>
<div class="line">[DBG] new fbdivfrac      0x21B3</div>
<div class="line">[DBG] new ro_div_frac    0x43666</div>
<div class="line">[DBG] NEW VALUES</div>
<div class="line"> cfgcr0 [0x164284] =     0x86CDD0</div>
<div class="line">[DBG] timer done</div>
<div class="line">[DBG] DEFAULT VALUES</div>
<div class="line"> cfgcr0 [0x164284] =     0x1001D0</div>
<div class="line"> cfgcr1 [0x164288] =     0x448</div>
<div class="line">[DBG] steps are 1000</div>
<div class="line">[DBG] OLD VALUES</div>
<div class="line"> cfgcr0 [0x16428C] =     0xE001A5</div>
<div class="line"> cfgcr1 [0x164290] =     0x48</div>
<div class="line">[DBG] old pll_freq   540.000000</div>
<div class="line">[DBG] new_pll_freq   540.540000</div>
<div class="line">[DBG] old dco_clock      8100.000000</div>
<div class="line">[DBG] new dco_clock      8108.100000</div>
<div class="line">[DBG] old fbdivfrac      0x3800</div>
<div class="line">[DBG] old ro_div_frac    0x2F0000</div>
<div class="line">[DBG] old fbdivint   0x1A6</div>
<div class="line">[DBG] old ro_div_int     0x34</div>
<div class="line">[DBG] new fbdivfrac      0x11300</div>
<div class="line">[DBG] new ro_div_frac    0x226001</div>
<div class="line">[DBG] NEW VALUES</div>
<div class="line"> cfgcr0 [0x16428C] =     0x44C01A6</div>
<div class="line">[DBG] timer done</div>
<div class="line">[DBG] DEFAULT VALUES</div>
<div class="line"> cfgcr0 [0x16428C] =     0xE001A5</div>
<div class="line"> cfgcr1 [0x164290] =     0x48</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md22"></a>
Debug Tools</h2>
<p>If you are doing debug, it helps to have the following libraries installed: </p><div class="fragment"><div class="line">apt install -y intel-gpu-tools edid-decode</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md23"></a>
Debug Tool Usage</h3>
<p>If you are encountering unexpected behavior that requires additional debug, the tools installed can assist with narrowing the potential problem.</p>
<p><b><a href="https://cgit.freedesktop.org/xorg/app/intel-gpu-tools/">intel-gpu-tools</a></b> Provides tools to read and write to registers, it must be run as the root user. Example:</p>
<div class="fragment"><div class="line">intel_reg dump --all &gt; /tmp/reg_dump.txt</div>
<div class="line"> </div>
<div class="line"># output excerpt</div>
<div class="line">                    GEN6_RP_CONTROL (0x0000a024): 0x00000400</div>
<div class="line">Gen6    disabled</div>
<div class="line">                      GEN6_RPNSWREQ (0x0000a008): 0x150a8000</div>
<div class="line">               GEN6_RP_DOWN_TIMEOUT (0x0000a010): 0x00000000</div>
<div class="line">           GEN6_RP_INTERRUPT_LIMITS (0x0000a014): 0x00000000</div>
<div class="line">               GEN6_RP_UP_THRESHOLD (0x0000a02c): 0x00000000</div>
<div class="line">                      GEN6_RP_UP_EI (0x0000a068): 0x00000000</div>
<div class="line">                    GEN6_RP_DOWN_EI (0x0000a06c): 0x00000000</div>
<div class="line">             GEN6_RP_IDLE_HYSTERSIS (0x0000a070): 0x00000000</div>
<div class="line">                      GEN6_RC_STATE (0x0000a094): 0x00040000</div>
<div class="line">                    GEN6_RC_CONTROL (0x0000a090): 0x00040000</div>
<div class="line">           GEN6_RC1_WAKE_RATE_LIMIT (0x0000a098): 0x00000000</div>
<div class="line">           GEN6_RC6_WAKE_RATE_LIMIT (0x0000a09c): 0x00000000</div>
<div class="line">        GEN6_RC_EVALUATION_INTERVAL (0x0000a0a8): 0x00000000</div>
<div class="line">             GEN6_RC_IDLE_HYSTERSIS (0x0000a0ac): 0x00000019</div>
<div class="line">                      GEN6_RC_SLEEP (0x0000a0b0): 0x00000000</div>
<div class="line">                GEN6_RC1e_THRESHOLD (0x0000a0b4): 0x00000000</div>
<div class="line">                 GEN6_RC6_THRESHOLD (0x0000a0b8): 0x00000000</div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">intel_reg read 0x00062400</div>
<div class="line">                PIPE_DDI_FUNC_CTL_C (0x00062400): 0x00000000 (disabled, no port, HDMI, 8 bpc, -VSync, -HSync, EDP A ON, x1)</div>
</div><!-- fragment --><p><b><a href="https://manpages.debian.org/unstable/edid-decode/edid-decode.1.en.html">edid-decode</a></b> is a tool used to parse the Extended Display Identification Data (EDID) from monitors and display devices. EDID contains metadata about the display's capabilities, such as supported resolutions, manufacturer, serial number, and other attributes.</p>
<p>To run edid-decode, you typically need to provide it with a binary EDID file or data. Sample usage: </p><div class="fragment"><div class="line">cat /sys/class/drm/card0-HDMI-A-1/edid &gt; edid.bin</div>
<div class="line"> </div>
<div class="line"># run edid-decode to parse and display the information</div>
<div class="line">edid-decode edid.bin</div>
<div class="line"> </div>
<div class="line"># sample output</div>
<div class="line">Extracted contents:</div>
<div class="line">header:          00 ff ff ff ff ff ff 00</div>
<div class="line">serial number:   10 ac 64 a4 4c 30 30 32</div>
<div class="line">version:         01 03</div>
<div class="line">basic params:    80 34 20 78 2e</div>
<div class="line">chroma info:     c5 c4 a3 57 4a 9c 25 12 50 54</div>
<div class="line">established:     bf ef 80</div>
<div class="line">standard:        71 4f 81 00 81 40 81 80 95 00 a9 40 b3 00 01 01</div>
<div class="line">descriptor 1:    4d d0 00 a0 f8 70 3e 80 30 20 35 00 55 50 21 00 00 1a</div>
<div class="line">descriptor 2:    02 3a 80 18 71 38 2d 40 58 2c 45 00 55 50 21 00 00 1e</div>
<div class="line">descriptor 3:    00 00 00 ff 00 43 32 30 30 38 30 4e 50 30 0a 20 20 20</div>
<div class="line">descriptor 4:    00 00 00 fd 00 32 4b 1e 53 11 00 0a 20 20 20 20 20 20</div>
<div class="line">extensions:      01</div>
<div class="line">checksum:        1c</div>
<div class="line"> </div>
<div class="line">Manufacturer: DEL Model a464 Serial Number 808909324</div>
<div class="line">Made week 12 of 2008</div>
<div class="line">EDID version: 1.3</div>
<div class="line">Digital display</div>
<div class="line">Maximum image size: 52 cm x 32 cm</div>
<div class="line">Gamma: 2.20</div>
<div class="line">DPMS levels: Standby Suspend Off</div>
<div class="line">RGB color display</div>
<div class="line">First detailed timing is preferred timing</div>
<div class="line">Display x,y Chromaticity:</div>
<div class="line">  Red:   0.6396, 0.3300</div>
<div class="line">  Green: 0.2998, 0.5996</div>
<div class="line">  Blue:  0.1503, 0.0595</div>
<div class="line">  White: 0.3134, 0.3291</div>
<div class="line">Established timings supported:</div>
<div class="line">  720x400@70Hz</div>
<div class="line">  640x480@60Hz</div>
<div class="line">  640x480@67Hz</div>
<div class="line">  640x480@72Hz</div>
<div class="line">  640x480@75Hz</div>
<div class="line">  800x600@56Hz</div>
<div class="line">  800x600@60Hz</div>
<div class="line">  ...</div>
<div class="line">Standard timings supported:</div>
<div class="line">  1152x864@75Hz</div>
<div class="line">  1280x800@60Hz</div>
<div class="line">  1280x960@60Hz</div>
<div class="line">  ...</div>
<div class="line">Detailed mode: Clock 148.500 MHz, 509 mm x 286 mm</div>
<div class="line">               1920 2008 2052 2200 hborder 0</div>
<div class="line">               1080 1084 1089 </div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md24"></a>
Generating Doxygen documents</h1>
<p>Please install doxygen and graphviz packages before generating Doxygen documents: <code>sudo apt install doxygen graphviz</code></p><ol type="1">
<li>Type <code>make doxygen VERSION="1.2.3"</code> from the main directory. It will generate SW Genlock doxygen documents to output/doxygen folder. Change the version to be that of the release number for the project.</li>
<li>Open output/doxygen/html/index.html with a web-browser</li>
</ol>
<h1><a class="anchor" id="autotoc_md25"></a>
Build Steps</h1>
<p>1) On the system, go to the directory where these files exist and set environment variable: </p><div class="fragment"><div class="line">export LD_LIBRARY_PATH=`pwd`/lib</div>
<div class="line">``````</div>
<div class="line">2) On the primary system, run it as follows:</div>
<div class="line">    ```console</div>
<div class="line">   ./synctest </div>
</div><!-- fragment --><p>Building of this program has been successfully tested on both Ubuntu 2x and Fedora 30.<br  />
</p>
<h2><a class="anchor" id="autotoc_md26"></a>
Preparing two systems for PTP communication</h2>
<p>In order to prepare two systems, please follow these steps:<br  />
</p><ol type="1">
<li>There should be a network cable directly connecting the ethernet ports of the two systems.</li>
<li>Apply <b><a href="./resources/0001-Revert-drm-vblank-remove-drm_timestamp_monotonic-par.patch">the monotonic timstamp patch</a></b> to Linux kernel i915 driver which allows it to provide vsync timestamps in real time instead of the default monotonic time.<br  />
 Note that the monotonic timestamp patch is generated based on Linux v6.4 and has been tested on Linux v6.4 and v6.5.<br  />
 Please follow the steps to disable monotonic timestamp after installing the local built Linux image on a target.<br  />
<ol type="a">
<li>Add <code>drm.timestamp_monotonic=0</code> option to <b>GRUB_CMDLINE_LINUX</b> in /etc/default/grub</li>
<li>Update <b>GRUB_DEFAULT</b> in /etc/default/grub to address the local built Linux image</li>
<li>Run <code>update-grub</code> to apply the change</li>
<li>Reboot a target</li>
</ol>
</li>
<li>Turn off NTP time synchronization service by using this command: <code>timedatectl set-ntp no</code></li>
<li><p class="startli">Run ptp sync on both the systems as root user.<br  />
 On the primary system, run the following command: <code>ptp4l -i enp176s0 -m -f gPTP.cfg</code><br  />
 On the secondary system, run the following command: <code>ptp4l -i enp176s0 -m -f gPTP.cfg -s</code></p>
<p class="startli">There must be a <b><a href="./resources/gPTP.cfg">gPTP.cfg</a></b> file present in the same directory from where you run the above two commands. The contents of this file should look like this:<br  />
</p>
<p class="startli">```shell </p>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md27"></a>
802.1AS example configuration containing those attributes which</h1>
<h1><a class="anchor" id="autotoc_md28"></a>
differ from the defaults.  See the file, default.cfg, for the</h1>
<h1><a class="anchor" id="autotoc_md29"></a>
complete list of available options.</h1>
<p>[global] gmCapable 1 priority1 248 priority2 248 logAnnounceInterval 0 logSyncInterval -3 syncReceiptTimeout 3 neighborPropDelayThresh 15000 min_neighbor_prop_delay -20000000 assume_two_step 1 path_trace_enabled 1 follow_up_info 1 transportSpecific 0x1 network_transport L2 delay_mechanism P2P ```</p>
<p>The output on the primary system after running the above command should look like this:<br  />
 ```console ptp4l[13416.983]: selected /dev/ptp1 as PTP clock ptp4l[13417.002]: port 1: INITIALIZING to LISTENING on INIT_COMPLETE ptp4l[13417.003]: port 0: INITIALIZING to LISTENING on INIT_COMPLETE ptp4l[13420.445]: port 1: LISTENING to MASTER on ANNOUNCE_RECEIPT_TIMEOUT_EXPIRES ptp4l[13420.445]: selected local clock 844709.fffe.04f07f as best master ptp4l[13420.445]: assuming the grand master role ```</p>
<p>The output on the secondary system after running the above command should look like this:<br  />
 ```console ptp4l[14816.313]: selected /dev/ptp1 as PTP clock ptp4l[14816.328]: port 1: INITIALIZING to LISTENING on INIT_COMPLETE ptp4l[14816.328]: port 0: INITIALIZING to LISTENING on INIT_COMPLETE ptp4l[14820.220]: port 1: new foreign master 844709.fffe.04f07f-1 ptp4l[14820.250]: selected local clock 844709.fffe.04eb0e as best master ptp4l[14822.220]: selected best master clock 844709.fffe.04f07f ptp4l[14822.220]: port 1: LISTENING to UNCALIBRATED on RS_SLAVE ptp4l[14822.650]: port 1: UNCALIBRATED to SLAVE on MASTER_CLOCK_SELECTED ptp4l[14823.275]: rms 158899 max 317730 freq -11742 +/- 3075 delay 14 +/- 0 ptp4l[14824.276]: rms 820 max 1257 freq -9067 +/- 1113 delay 14 +/- 0 ptp4l[14825.277]: rms 1366 max 1436 freq -6582 +/- 359 delay 13 +/- 0 ptp4l[14826.278]: rms 866 max 1148 freq -6099 +/- 34 delay 13 +/- 0 ptp4l[14827.279]: rms 280 max 465 freq -6364 +/- 102 delay 12 +/- 0 ptp4l[14828.280]: rms 52 max 80 freq -6666 +/- 65 delay 12 +/- 0 ptp4l[14829.280]: rms 82 max 88 freq -6805 +/- 21 delay 12 +/- 0 ptp4l[14830.281]: rms 50 max 69 freq -6829 +/- 3 delay 12 +/- 0 ptp4l[14831.282]: rms 15 max 28 freq -6811 +/- 7 delay 12 +/- 0 ptp4l[14832.283]: rms 4 max 8 freq -6795 +/- 5 delay 12 +/- 0 ptp4l[14833.284]: rms 7 max 10 freq -6783 +/- 3 delay 12 +/- 0 ptp4l[14834.285]: rms 2 max 5 freq -6788 +/- 3 delay 13 +/- 0 ptp4l[14835.286]: rms 3 max 5 freq -6793 +/- 3 delay 13 +/- 0 ```</p>
<p>Please make it sure that the secondary sytem refers to the primary's precision time by checking if there is the __"new foreign master"__ message in a log<br  />
 Note that the rms value should be decreasing with each line and should go down to single digits.</p>
<ol type="1">
<li>While step #4 is still executing, synchronize wall clocks of the system as the root user.<br  />
 On both the primary &amp; secondary systems, run the following command: <code>phc2sys -s enp176s0 -O 0 -R 8 -u 8 -m</code><br  />
 In the above command, replace enp176s0 with the ethernet interface that you find on your systems where the network cable is connected to. Steps 4 &amp; 5 will synchronize the wall clocks of the two systems. You can stop these commands from executing by pressing Ctrl+C on both systems. Now you are ready to execute the vsync_test.</li>
</ol>
<p>Installing and running the programs:<br  />
</p><ol type="1">
<li>Copy the release folder contents to both primary and secondary systems.<br  />
</li>
<li>On both systems, go to the directory where these files exist and set environment variable: export LD_LIBRARY_PATH=.<br  />
</li>
<li>On the primary system, run it as follows: <code>./vsync_test pri [PTP_ETH_Interface]</code><br  />
</li>
<li>On the secondary system, run it as follows: <code>./vsync_test sec PTP_ETH_Interface [Primary_ETH_MAC_Addr] [sync after # us]</code></li>
</ol>
<p>This program runs in server mode on the primary system and in client mode on the secondary system.</p>
<p>If using PTP protocol to communicate between primary and secondary, there are some extra parameters required. The primary system must identify the PTP Interface (ex: enp176s0). The secondary system also requires its PTP interface as well as this port's ethernet MAC address. An example of PTP communication between primary and secondary looks like this: On the primary system, run it as follows: <code>./vsync_test pri enp176s0</code><br  />
 On the secondary system, run it as follows: <code>./vsync_test sec enp176s0 84:47:09:04:eb:0e</code></p>
<p>In the above examples, we were just sync'ing the secondary system once with the primary. However, due to reference clock differences, we see that there is a drift pretty much as soon as we have sync'd them. We also have another capability which allows us to resync as soon as it goes above a threshold. For example: <br  />
 On the primary system, run it as follows: <code>./vsync_test pri enp176s0</code><br  />
 On the secondary system, run it as follows: <code>./vsync_test sec enp176s0 84:47:09:04:eb:0e 100</code></p>
<p>In the above example, secondary system would sync with the primary once but after that it would constantly check to see if the drift is going above 100 us. As soon as it does, the secondary system would automatically resync with the primary. It is recommended to select a large number like 60 or 100 since if we use a smaller number, then we will be resyncing all the time. On the other hand, if we chose a really big number like 1000 us, then we are allowing the systems to get out of sync from each other for 1 ms. On a Tiger Lake system, 100 us difference is usually happening in around 60-70 seconds or about a minute. So this program would automatically resync with the primary every minute or so. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jun 5 2024 23:23:15 for Software Genlock by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
